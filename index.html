<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pressly Research Study</title>
    
    <!-- PWA Configuration -->
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Pressly Study">
    
    <!-- Inline Manifest -->
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiUHJlc3NseSBSZXNlYXJjaCBTdHVkeSIsInNob3J0X25hbWUiOiJQcmVzc2x5IiwiZGVzY3JpcHRpb24iOiJSZXNlYXJjaCBzdHVkeSBwYXJ0aWNpcGF0aW9uIGFwcCIsInN0YXJ0X3VybCI6Ii8iLCJkaXNwbGF5Ijoic3RhbmRhbG9uZSIsImJhY2tncm91bmRfY29sb3IiOiIjZmZmZmZmIiwidGhlbWVfY29sb3IiOiIjMjU2M2ViIiwib3JpZW50YXRpb24iOiJwb3J0cmFpdCIsImljb25zIjpbeyJzcmMiOiJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXhPVElpSUdobGFXZG9kRDBpTVRreUlpQjJhV1YzUW05NFBTSXdJREFnTVRreUlERTVNaUkrUEhKbFkzUWdkMmxrZEdnOUlqRTVNaUlnYUdWcFoyaDBQU0l4T1RJaUlHWnBiR3c5SWlNeU5UWXpaV0lpSUM4K1BIUmxlSFFnZUQwaU9UWWlJSGs5SWpFeE5pSWdkR1Y0ZEMxaGJtTm9iM0k5SW0xcFpHUnNaU0lnWm1sc2JEMGlJM2RvYVhSbElpQm1iMjUwTFhOcGVtVTlJakUySWlCbWIyNTBMV1poYldsc2VUMG9ZWEpwWVd3aUlHWnZiblF0ZDJWcFoyaDBQU0ppYjJ4a0lpQmpiR0Z6Y3owaWJHVjBkR1Z5WDA5aUlpQndQU0l3SWo1UVBDOTBAWHF3Wlh2VStOQU09PSIsInNpemVzIjoiMTkyeDE5MiIsInR5cGUiOiJpbWFnZS9zdmcreG1sIn0seyJzcmMiOiJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSTFNVElpSUdobGFXZG9kRDBpTlRFeUlpQjJhV1YzUW05NFBTSXdJREFnTlRFeUlEVXhNaUkrUEhKbFkzUWdkMmxrZEdnOUlqVXhNaUlnYUdWcFoyaDBQU0kxTVRJaUlHWnBiR3c5SWlNeU5UWXpaV0lpSUM4K1BIUmxlSFFnZUQwaU1qVTJJaUI1UFNJeU9EQWlJSFJsZUhRdFlXNWphRzl5UFNKdGFXUmtiR1VpSUdacGJHdzlJaU4zYUdsMFpTSWdabTl1ZEMxemFYcGxQU0kwTkNJZ1ptOXVkQzFtWVcxcGJIazlJaUZoY21saGJDSWdabTl1ZEMxM1pXbG5hSFE5SW1KdmJHUWlJR05zWVhOelBTSnNaWFIwWlhKZlQySWlJSEE5SWpBaVBsQThMM1JsZUhRK1BDOXpkbWMrIiwic2l6ZXMiOiI1MTJ4NTEyIiwidHlwZSI6ImltYWdlL3N2Zyt4bWwifV19">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .app-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .app-title {
            font-size: 2rem;
            font-weight: bold;
            color: #2563eb;
            text-align: center;
        }
        
        .container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        .welcome-card {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .welcome-title {
            font-size: 1.8rem;
            color: #2563eb;
            margin-bottom: 1rem;
        }
        
        .welcome-text {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #666;
            margin-bottom: 2rem;
        }
        
        .nav-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }
        
        .nav-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 1.5rem;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: block;
            text-align: center;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .nav-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .section {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            display: none;
        }
        
        .section.active {
            display: block;
        }
        
        .section-title {
            font-size: 1.5rem;
            color: #2563eb;
            margin-bottom: 1rem;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 0.5rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #374151;
        }
        
        .form-input {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #2563eb;
        }
        
        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
        }
        
        .back-btn {
            background: #6b7280;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            cursor: pointer;
            margin-right: 1rem;
            transition: all 0.3s ease;
        }
        
        .back-btn:hover {
            background: #4b5563;
        }
        
        .install-prompt {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 1rem;
            border-radius: 15px;
            margin: 1rem;
            text-align: center;
            display: none;
        }
        
        .install-btn {
            background: white;
            color: #d97706;
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            margin-top: 0.5rem;
            font-weight: 600;
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .app-header {
                padding: 1rem;
            }
            
            .app-title {
                font-size: 1.5rem;
            }
            
            .welcome-card, .section {
                padding: 1.5rem;
                margin: 1rem;
            }
            
            .nav-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Install Prompt -->
    <div id="installPrompt" class="install-prompt">
        <div>üì± Install this app on your device for the best experience!</div>
        <button id="installBtn" class="install-btn">Install App</button>
    </div>

    <header class="app-header">
        <h1 class="app-title">Pressly Research Study</h1>
    </header>

    <div class="container">
        <!-- Home Section -->
        <div id="home" class="section active">
            <div class="welcome-card">
                <h2 class="welcome-title">Welcome to the Pressly Research Study</h2>
                <p class="welcome-text">
                    Thank you for participating in our research study. This app will guide you through 
                    the participation process and help us collect valuable data for our research.
                </p>
                <div class="nav-buttons">
                    <button class="nav-button" onclick="showSection('participate')">
                        üìù Participate in Study
                    </button>
                    <button class="nav-button" onclick="showSection('information')">
                        ‚ÑπÔ∏è Study Information
                    </button>
                    <button class="nav-button" onclick="showSection('contact')">
                        üìû Contact Researchers
                    </button>
                    <button class="nav-button" onclick="showSection('admin')">
                        ‚öôÔ∏è Admin Access
                    </button>
                </div>
            </div>
        </div>

        <!-- Participation Section -->
        <div id="participate" class="section">
            <h2 class="section-title">Study Participation</h2>
            <form id="participationForm">
                <div class="form-group">
                    <label class="form-label" for="participantId">Participant ID:</label>
                    <input type="text" id="participantId" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="age">Age:</label>
                    <input type="number" id="age" class="form-input" min="18" max="100" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="gender">Gender:</label>
                    <select id="gender" class="form-input" required>
                        <option value="">Select Gender</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Other</option>
                        <option value="prefer-not-to-say">Prefer not to say</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="responses">Study Responses:</label>
                    <textarea id="responses" class="form-input form-textarea" 
                              placeholder="Please provide your responses to the study questions here..." required></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="feedback">Additional Feedback (Optional):</label>
                    <textarea id="feedback" class="form-input form-textarea" 
                              placeholder="Any additional comments or feedback..."></textarea>
                </div>
                
                <button type="button" class="back-btn" onclick="showSection('home')">‚Üê Back</button>
                <button type="submit" class="submit-btn">Submit Response</button>
            </form>
        </div>

        <!-- Information Section -->
        <div id="information" class="section">
            <h2 class="section-title">Study Information</h2>
            <div class="form-group">
                <h3 style="color: #2563eb; margin-bottom: 1rem;">About This Study</h3>
                <p style="line-height: 1.6; margin-bottom: 1rem;">
                    This research study is designed to collect data for academic research purposes. 
                    Your participation is voluntary and all data will be kept confidential.
                </p>
                
                <h3 style="color: #2563eb; margin-bottom: 1rem; margin-top: 2rem;">Privacy & Confidentiality</h3>
                <p style="line-height: 1.6; margin-bottom: 1rem;">
                    All data collected will be anonymized and used solely for research purposes. 
                    Your personal information will not be shared with third parties.
                </p>
                
                <h3 style="color: #2563eb; margin-bottom: 1rem; margin-top: 2rem;">Contact Information</h3>
                <p style="line-height: 1.6;">
                    If you have any questions about this study, please contact the research team 
                    using the contact form in this app.
                </p>
            </div>
            <button type="button" class="back-btn" onclick="showSection('home')">‚Üê Back to Home</button>
        </div>

        <!-- Contact Section -->
        <div id="contact" class="section">
            <h2 class="section-title">Contact Researchers</h2>
            <form id="contactForm">
                <div class="form-group">
                    <label class="form-label" for="contactName">Your Name:</label>
                    <input type="text" id="contactName" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="contactEmail">Your Email:</label>
                    <input type="email" id="contactEmail" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="contactSubject">Subject:</label>
                    <input type="text" id="contactSubject" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="contactMessage">Message:</label>
                    <textarea id="contactMessage" class="form-input form-textarea" 
                              placeholder="Your message to the research team..." required></textarea>
                </div>
                
                <button type="button" class="back-btn" onclick="showSection('home')">‚Üê Back</button>
                <button type="submit" class="submit-btn">Send Message</button>
            </form>
        </div>

        <!-- Admin Section -->
        <div id="admin" class="section">
            <h2 class="section-title">Admin Access</h2>
            <form id="adminForm">
                <div class="form-group">
                    <label class="form-label" for="adminPassword">Admin Password:</label>
                    <input type="password" id="adminPassword" class="form-input" required>
                </div>
                
                <button type="button" class="back-btn" onclick="showSection('home')">‚Üê Back</button>
                <button type="submit" class="submit-btn">Access Admin Panel</button>
            </form>
            
            <div id="adminPanel" style="display: none; margin-top: 2rem;">
                <h3 style="color: #2563eb; margin-bottom: 1rem;">Admin Dashboard</h3>
                <div class="nav-buttons">
                    <button class="nav-button" onclick="viewResponses()">
                        üìä View Responses
                    </button>
                    <button class="nav-button" onclick="exportData()">
                        üì• Export Data
                    </button>
                    <button class="nav-button" onclick="manageStudy()">
                        ‚öôÔ∏è Manage Study
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('data:application/javascript;base64,' + btoa(`
                    const CACHE_NAME = 'pressly-study-v1';
                    const urlsToCache = ['/'];
                    
                    self.addEventListener('install', function(event) {
                        event.waitUntil(
                            caches.open(CACHE_NAME)
                                .then(function(cache) {
                                    return cache.addAll(urlsToCache);
                                })
                        );
                    });
                    
                    self.addEventListener('fetch', function(event) {
                        event.respondWith(
                            caches.match(event.request)
                                .then(function(response) {
                                    return response || fetch(event.request);
                                })
                        );
                    });
                `))
                .then(function(registration) {
                    console.log('SW registered');
                }).catch(function(registrationError) {
                    console.log('SW registration failed');
                });
            });
        }

        // Install Prompt
        let deferredPrompt;
        const installPrompt = document.getElementById('installPrompt');
        const installBtn = document.getElementById('installBtn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installPrompt.style.display = 'block';
        });

        installBtn.addEventListener('click', (e) => {
            installPrompt.style.display = 'none';
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    deferredPrompt = null;
                });
            }
        });

        // App Navigation
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
        }

        // Form Handlers
        document.getElementById('participationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = {
                participantId: document.getElementById('participantId').value,
                age: document.getElementById('age').value,
                gender: document.getElementById('gender').value,
                responses: document.getElementById('responses').value,
                feedback: document.getElementById('feedback').value,
                timestamp: new Date().toISOString()
            };
            
            // Store data (in real app, this would go to your server)
            const responses = JSON.parse(localStorage.getItem('studyResponses') || '[]');
            responses.push(formData);
            localStorage.setItem('studyResponses', JSON.stringify(responses));
            
            alert('Thank you! Your response has been submitted successfully.');
            this.reset();
            showSection('home');
        });

        document.getElementById('contactForm').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Thank you for your message. We will get back to you soon!');
            this.reset();
            showSection('home');
        });

        document.getElementById('adminForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const password = document.getElementById('adminPassword').value;
            
            // Simple password check (in real app, use proper authentication)
            if (password === 'admin123') {
                document.getElementById('adminPanel').style.display = 'block';
                alert('Access granted!');
            } else {
                alert('Invalid password!');
            }
        });

        // Admin Functions
        function viewResponses() {
            const responses = JSON.parse(localStorage.getItem('studyResponses') || '[]');
            if (responses.length === 0) {
                alert('No responses yet.');
                return;
            }
            
            let output = 'STUDY RESPONSES:\\n\\n';
            responses.forEach((response, index) => {
                output += `Response ${index + 1}:\\n`;
                output += `ID: ${response.participantId}\\n`;
                output += `Age: ${response.age}\\n`;
                output += `Gender: ${response.gender}\\n`;
                output += `Responses: ${response.responses}\\n`;
                output += `Feedback: ${response.feedback}\\n`;
                output += `Time: ${new Date(response.timestamp).toLocaleString()}\\n`;
                output += '\\n---\\n\\n';
            });
            
            alert(output);
        }

        function exportData() {
            const responses = JSON.parse(localStorage.getItem('studyResponses') || '[]');
            if (responses.length === 0) {
                alert('No data to export.');
                return;
            }
            
            const dataStr = JSON.stringify(responses, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'study-responses.json';
            link.click();
            URL.revokeObjectURL(url);
        }

        function manageStudy() {
            alert('Study management features would be implemented here.');
        }

        // Make app feel more native
        document.addEventListener('touchstart', function() {}, true);
        
        // Prevent zoom on double tap
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    </script>
</body>
</html>
